{
  "paper_id": "2107.09510v3",
  "title": "Modality Fusion Network And Personalized Attention In Momentary Stress Detection In The Wild",
  "published": "2021-07-19T07:54:33Z",
  "authors": [
    "Han Yu",
    "Thomas Vaessen",
    "Inez Myin-Germeys",
    "Akane Sano"
  ],
  "keywords": [
    "Wearable Sensors",
    "Stress",
    "Neural Network",
    "Incomplete Modalities",
    "Personalized Model",
    "Attention"
  ],
  "sections": [
    {
      "section_name": "Abstract",
      "text": "Multimodal wearable physiological data in daily life settings have been used to estimate self-reported stress labels. However, missing data modalities in data collection make it challenging to leverage all the collected samples. Besides, heterogeneous sensor data and labels among individuals add challenges in building robust stress detection models. In this paper, we proposed a modality fusion network (MFN) to train models and infer self-reported binary stress labels under both complete and incomplete modality condition. In addition, we applied a personalized attention (PA) strategy to leverage personalized representation along with the generalized one-size-fits-all model. We evaluated our methods on a multimodal wearable sensor dataset (N=41) including galvanic skin response (GSR) and electrocardiogram (ECG). Compared to the baseline method using the samples with complete modalities, the performance of the MFN improved by 1.6% in f1-scores. On the other hand, the proposed PA strategy showed a 2.3% higher stress detection f1-score and approximately up to 70% reduction in personalized model parameter size (9.1 MB) compared to the previous stateof-the-art transfer learning strategy (29.3 MB).",
      "page_start": 1,
      "page_end": 1
    },
    {
      "section_name": "I. Introduction",
      "text": "Psycho-social stress is a common phenomenon that can benefit people under certain circumstances and increase resilience to future stressors. Especially exposure to moderate stress levels can be beneficial as it can prepare an organism to deal with future challenges  [1] . On the other hand, stress has also been associated with an increased risk for a large number of somatic and mental illnesses  [2] . Prolonged exposure to a stressful environment increases risks for cardiovascular health issues  [3]  and suppresses the human immune system  [4] . Effectively detecting moments of stress in real life may provide opportunities to help individuals manage their stress early on to promote resilience and wellbeing.\n\nIn recent years, the rapid development of mobile sensors and machine learning algorithms have brought the opportunity to measure momentary human stress using passive multimodal physiological sensor data such as heart rate, sleep activity, galvanic skin response (GSR), and blood volume pulse (BVP)  [5] -  [7] . These prior works have shown promising This work is supported by NSF #2047296 and #1840167 results and have revealed the feasibility of using multimodal physiological data to monitor human stress. However, we hypothesize addressing the following two issues can provide further improvement.\n\nMissing modalities are common in real-world multimodal sensor data since it is challenging to ensure that all sensors function continuously throughout data collection period. The studies mentioned above only used data with all complete modalities of features to maintain the quality of data used for stress modeling; however, as one of the previous methods, discarding samples with incomplete modalities leads to information loss. For example, in a case that data from one sensor (e.g., a chest-worn sensor) were not collected as expected due to various reasons such as sensor malfunction or battery drainage, nevertheless, data from wrist-worn sensors and participants' subjective stress labels were collected, the stress label can be still estimated only using the data from the wrist-worn sensor rather than discarding those samples. Deep learning methods with missing modalities has been developed in computer vision and natural language processing  [8] -  [10] . Some prior studies also developed deep learning methods to impute the missing modalities in human emotion studies  [11] -  [15] . However, the data reconstruction errors from models such as principle component analysis and auto-encoder in these methods would introduce biases into the imputed modalities, especially when the entire modalities were missing in the input samples. In this work, instead of pre-imputing the physiological data, we proposed an end-to-end modality fusion network (MFN), which models the data from two sensors under the either complete or incomplete modalities situation.\n\nHeterogeneous sensor data and labels among individuals are another common problem that affects the robustness of stress detection models. Heterogeneity exists in both collected sensors data and self-reported stress labels. For instance, physiological measurements show the differences in heart rates and body acceleration for different persons; meanwhile, the perception of stress varies from person to person. Thus, it is difficult to build a one-size-fits-all model that estimates stress status accurately for every participant. Some prior studies have leveraged individual heterogeneity in modeling stress  [16] -  [19] . Taylor et al. clustered participants' data based on the genders and personality information and applied a multitask learning strategy to predict participants' wellbeing labels include stress as different tasks  [17] . Yu et al. transferred a one-size-fits-all model on each subject's data and observed an improved overall stress prediction accuracy  [19] . Nevertheless, these methods cannot fully solve issues in heavy computational complexity and weak model adaptability, which prevent these models from being used in real-world applications and benefiting people. For example, if 25 different groups of participants (25 output branches) are found and used in the above multitask learning model, only one branch is available for a sample during training and prediction. This mechanism causes the remaining 24 branches to perform unnecessary computations. In this work, we designed a personalized attention mechanism, which provided over 77% f1-score in personalized stress estimation with low computational cost and flexible adaptability.\n\nTo summarize our contributions:\n\n• We proposed an MFN model structure to estimate binary momentary stress labels even with missing data modalities of wearable sensor data. • We designed a personalized attention strategy to model momentary stress with individual heterogeneity. This method provided more accurate stress estimation results with less computation cost and smaller model parameters size compared to the previous methods.",
      "page_start": 1,
      "page_end": 1
    },
    {
      "section_name": "Ii. Related Work",
      "text": "With the development of mobile phones and wearable devices, accessing users' physiological and behavioral data in daily life settings has become popular. Machine learning enables us to develop models to learn patterns from data samples and has already benefited ubiquitous computing applications. Multimodal data from wearable sensors, mobile phones, and other smart devices have been widely used with machine learning in estimating momentary stress levels  [5] -  [7] . Shi et al. collected 22 subjects' electrocardiogram (ECG), GSR, respiration (RIP), and skin temperature (ST) data using wearable sensors  [7] . Each subject in the study was exposed to a protocol, including four stressors and six rest periods, and stress labels were collected before and after each stressor/rest period through interviews. Then the authors proposed a personalized SVM algorithm to classify binary stress labels (low/high), which provided 0.68 precision with 0.80 recall. Some studies have also compared the effects of using different sensor modalities on stress estimation models  [16] ,  [20] ,  [21] . For example, Can et al. compared the performance of stress estimation using different sensor devices and various signal types  [16] . They used two types of sensors: the Empatica E4 sensor and the Samsung Gear S-S2, and their results showed that the combined modalities of heart rate with electrodermal activity fitted the model with the highest accuracy. These works inspired us with the important insight that we can estimate stress by using different modalities separately while using different modalities in combination often yields better estimation results.\n\nHowever, the modality missing issue is inevitable in multimodal data collection. To ease the loss from incomplete modalities, researchers have proposed various deep learning network structures  [8] -  [10] ,  [22] . For example, Ma et al. proposed a multimodal learning with severely missing modality model, which used Bayesian meta-learning to reconstruct severely missing modalities with valid modalities  [8] . They evaluated the proposed method on the MM-IMDb dataset (image + text) and CMU-MOSI dataset (image + audio), and showed that the model achieved higher performances on both datasets than the baseline models. Researchers also designed methods of imputing missing values in multimodal physiological dataset  [11] -  [13] . Jaques et al. proposed an auto-encoder structure (MMAE) that imputed missing values in multimodal human physiological and behavioural data  [11] . The MMAE methods outperformed the baseline principal component analysis method in data reconstruction root mean squared error (RMSE) metrics. Zhang et al. proposed a sequenceto-sequence imputation model (SSIM) framework to impute missing values for multimodal time-series sensor data  [12] . Their evaluated model achieved up to 69.2% improvement in the reconstruction RMSE score compared to a baseline matrix factorization method. To the best of our knowledge, there is no previously designed end-to-end model that adaptively used different physiological modalities and their combinations to perceive stress labels without reconstructing the missing modalities.\n\nSince the subjectively perceived stress of participants is related to individually heterogeneous sensor data and labels, the model personalization has also been a topic of interest for researchers  [16] -  [19] . For example, Taylor et al.  [17]  applied a K-Means algorithm to cluster participants into different groups by their personality survey and gender information. Using the group information, they built diverse output branches in the neural network for different groups of participants to implement multi-task learning. These works all concluded that personalized models achieved better performance in human stress estimation than generalized models. However, there were drawbacks in these previous works. For example, in multi-task learning models, high computational complexity and low adaptability for new participants to the pretrained models have been a existing problem. If there is discrepancy in data characteristics between new participants and the participants used for training models, the multi-task learning model needs to be re-trained. On the other hand, although the transfer learning strategy adapts the model to new samples, storing the parameters of the transfer learning model might not be efficient in real-world applications. For each individual, parameters of the fine-tuned layers as well as the whole model might need to be stored on each edge device, which is detrimental to the system's space complexity.",
      "page_start": 2,
      "page_end": 2
    },
    {
      "section_name": "Iii. Data Set",
      "text": "In this study, wearable sensor and self-report data were collected from 41 healthy participants (36 females and 5 GSR area -the sum of the area of GSR responses in seconds. The area is defined using the triangular method (1/2 x GSR magnitude x GSR duration) GSR males). The average age of participants was 24.5 years old, with a standard deviation of 3.0 years.",
      "page_start": 2,
      "page_end": 2
    },
    {
      "section_name": "A. Wearable Sensor Data",
      "text": "Two types of wearable sensors were used for data collection  [23] . One was a wrist-worn device (Chillband, IMEC, Belgium) designed for the measurement of galvanic skin response (GSR), which was sampled at 256 Hz. Participants wore the sensor for the entire testing period, but could take it off during the night and while taking a shower or during vigorous activities. The second sensor was a chest patch (Health Patch, IMEC, Belgium) to measure ECG. It contains a sensor node designed to monitor ECG at 256 Hz throughout the study period. Participants could remove the patch while showering or before doing intense exercises.\n\nData from both chest and wrist wearable sensors were sorted based on their timestamps, and a set of 16 features was computed. Table  I  shows the features computed from ECG and GSR signals with 5-minute sliding windows with 4-minute overlapping segments  [23] .",
      "page_start": 3,
      "page_end": 3
    },
    {
      "section_name": "B. Momentary Stress Labels",
      "text": "In addition to the physiological data collected by sensors, participants received notifications on their mobile phones to report their momentary stress levels 10 times at random timing per day for eight consecutive days. In total, 2494 stress labels were collected across all participants (80% compliance). The stress scale ranged from 0 (\"not at all\") to 6 (\"very\"). The portions of each stress level's labels were 44.8%, 17.8%, 13.4%, 11.2%, 3.4%, and 1.0% from no stress at all to the highest stress level, respectively.\n\nIV. METHODS This section introduces the details of our methods in building a stress detection system, including data pre-processing, baseline self-attention network (SAN), MFN, and PA.",
      "page_start": 3,
      "page_end": 3
    },
    {
      "section_name": "A. Data Pre-Processing",
      "text": "We split each participant's data into 60-minute time windows, and any time windows with missing data points were omitted. There are 1123 valid sequences from GSR features, whereas 2107 sequences with ECG features, respectively. After merging these two modalities, only 938 sequential samples can be used to build the stress detection model using both modalities.\n\nStress labels were divided by the participants' self-reported stress status. We coded the stress status 0 as non-stressed labels and the rest 1-6 stess status stressed label to build a binary classifier. The ratio of the number of non-stressed labels and stressed labels was 45% to 55%.",
      "page_start": 4,
      "page_end": 4
    },
    {
      "section_name": "B. Self-Attention Network",
      "text": "In recent years, time series learning has attracted attention from researchers. For example, as an essential member in the neural network family, recurrent neural network (RNN) was used in stock price prediction  [24] , machine translation  [25] , and music generation  [26] . However, RNN has drawbacks such as high computational complexity and weak long-term dependency learning ability. To address long-term dependency issues, an attention mechanism with RNN has been used and achieved improvements in different areas  [27] ,  [28] . Further, the Transformer  [29] , a structure that uses only the attention mechanism without the computational-heavy RNN unit has been developed. The Transformer achieved state-of-the-art performances in multiple applications  [29] ,  [30] . In this study, we applied the self-attention mechanism in the Transformer to extract representations from the 60-minute input sequential physiological data (60 steps x 1 min). The model outputted the results of stress detection in non-stressed/stressed binary labels.\n\nAccording to the  [29] , self-attention (Figure  1 ), which is an attention mechanism relating different positions of a single sequence to compute the representations, can be defined as:\n\nwhere Q, K, and V are the linear mappings from the original sequence X, and d k represents the dimension of matrix Q and K. The above equation can be understood as the embedding of matrix Q with the references of V . The scale factor √ d k regulates the parameters and avoids the vanishing issues of the softmax gradient when the inner product of Q and K is large.\n\nAs stated in the original work  [29] , the single self-attention mechanism may not be robust enough. Therefore, we decided to use a multi-headed attention mechanism, which is the concatenation of multiple self-attention layers to improve this problem. The multi-head attention can be referred to:\n\nFig.  1 . The self-attention mechanism. X is the data input, Q, K, and V are the projection matrices of X.\n\nwhere h is the number of the concatenated self-attention layers in a multi-head attention layer. Intuitively, this algorithm calculates the self-attention using equation 1 for h times and concatenates the results from all calculations. In this work, we tuned the h as 4. As shown in Figure  2 , we defined a self-attention block as an in-series combination of a multihead attention layer, two \"Add & Normalization\" layers, and one dense layer. The \"Add & Normalization\" layers residually connected  [31]  the input and multi-head attention to avoid the over-fitting issue, then parameters were also normalized in this layer to speed up the model optimization. A dense layer was also included in a self-attention block to feed forward information extracted by the multi-head attention. As shown in Figure  2 , to make the model deeper and gain higher generalizability, we applied three such self-attention blocks in series to form the baseline SAN model. Besides, since the self-attention mechanism cannot extract the temporal representation, we applied a sinusoidal positional encoding method as in  [29] , which generated the sequences of tokens to help the model recognize the relative positions of each time step in the input sequences.",
      "page_start": 3,
      "page_end": 4
    },
    {
      "section_name": "C. Modality Fusion Network",
      "text": "As the data statistics was shown in section IV-A, the number of valid ECG sequential samples was about 2 -2.5 times larger than the number of the valid GSR samples and the number of samples with complete 2 modalities. Thus, to fully leverage the collected data, it is crucial to develop a model that can handle both incomplete and complete modalities. In this work, we proposed an MFN model shown in Figure  3 . This MFN model adaptively leverages multimodal data to model stress patterns as explained in the next paragraph.\n\nTraining: Training procedures of the MFN network adapt to the missing condition of modalities. For example, if only the ECG data is valid in samples, we inputted randomly generated values into the GSR branch. However, the loss weights of both the GSR branch and the concatenated branch were set as 0. In this case, the model was only optimized through the ECG branch (blue in Figure  3 ). Similarly, the exact optimization mechanism was also applied in the case where only GSR data was available. The model would be optimized through all three output paths on the samples with both modalities. The loss function of MFN is written as:\n\n) Where I G , I E , and I GE are the indicator functions for missing modalities. For instance, I G and I GE are both 0 when the GSR data is missing.\n\nStress Inference: For inferring stress labels from MFN, we selected the outputs according to input data modality availability. If there was no missing modality, the concatenated output cell results were used as the final estimation. Otherwise, we selected the results from the branch with available modalities as the output of the model.",
      "page_start": 4,
      "page_end": 5
    },
    {
      "section_name": "D. Personalized Attention",
      "text": "Learning personalized models from heterogeneous data with individual differences is still a challenging topic in human behavioral modeling. For example, in a recommendation system, personalized differences need to be considered to provide proper recommendations to users.\n\nIn this study, inspired by the method in  [32] , we designed a personalized attention framework to combine the generalized information from a one-size-fits-all MFN model with the individual representations learned from tiny personalized subbranches. Figure  4  shows the structure of the MFN-integrated PA framework designed in this work. In both the GSR and ECG branches in MFN, we added sub-branches using SAN with only one self-attention block as personalized attention layers. As a pre-preparation step for this structure, a one-sizefits-all MFN (section IV-C) model was fitted with all participants' data in training set. Then, we fixed the parameters in the generalized MFN and constructed a personalized attention branch for individuals to learn personalized representations. The personalized branch structure can be considered a small MFN, with only one self-attention block instead of three blocks in a standard MFN. During the model training process, only parameters in the personalized attention layer and the concatenate and output layer are trainable. To fit the data for each participant, we initialized the parameters in the personalized attention layer for different individuals so that the network learned parameters for each participant that were specific to that participant only.",
      "page_start": 4,
      "page_end": 5
    },
    {
      "section_name": "E. Focal Loss",
      "text": "In this work, as shown in Section III, the stress labels are not uniformly distributed. To avoid the issues from data imbalance, i.e., the classifier was dominated by the major class, caused by imbalanced data sets, we applied a focal loss  [33]  as the loss function of our model. The focal loss is written as:\n\nwhere p t is a raw sigmoid output from the model, and γ is the focusing parameter. The purpose of using this loss function is to make the model more focused on hard-to-classify samples during training by reducing the weights of easy-to-classify samples. The γ value we used in this study was 2.",
      "page_start": 5,
      "page_end": 5
    },
    {
      "section_name": "V. Experiments",
      "text": "Considering that human behavior patterns or stress perceptions might change over time, we referred to the study timeline for splitting the participants' data to simulate the realistic conditions. We sorted the reported stress labels for each participant by the time of reporting, and then we selected the first 70% as our training set and the latter 30% as our test set. With this setup, we can ensure that there is not any time series overlap between the training and test sets and simulate using a model fitted by past data to infer future unseen data. Furthermore, to avoid biases from different model initialization that leads to the lack of rigor in comparing evaluation results, we repeated the training and testing process five times.\n\nAfter splitting the dataset, the numbers of positive and negative samples were not equal in the training and the test set. Therefore, considering the bias of accuracy rate caused by the imbalance problem, we chose the f1-score as the metric in our model performance evaluations.\n\nThe following experiments were conducted to evaluate our proposed methods.",
      "page_start": 5,
      "page_end": 5
    },
    {
      "section_name": "A. Modality Fusion Evaluation",
      "text": "As described in sections III, we have two different data modalities, ECG and GSR. There are three different possible scenarios of data availability: i) ECG data only, ii) GSR data only, and iii) both. In this experiment, we used SAN and MFN in 3 scenarios (i), (ii), and (iii) and compared their stress detection performances. As SAN requires fixed input dimensions, we used 3 SAN models to model (i), (ii), and (iii), respectively; while one MFN model was used to estimate stress labels for all 3 scenarios. Further, a paired t-test was applied to compare the performances of SAN and MFN.",
      "page_start": 5,
      "page_end": 5
    },
    {
      "section_name": "B. Model Personalization",
      "text": "For evaluating the personalized model, we used the generalized MFN model as a baseline. Then we compared the personalized MFN model with the baseline to assess improvement from personalization. We also applied the previous transfer learning strategy  [19]  on this dataset for comparing the personalized MFN and the previous state-of-the-art transfer learning method. To implement the transfer learning method on our dataset, we first trained a one-size-fits-all MFN model based on all subjects' training data. Using the parameters of the generalized model as the initialization, we fixed the parameters in the first two blocks of the MFN and fine-tuned the last MFN block parameters for each participant. In this experiment, in addition to calculate f1-score of the stress detection results, we also evaluated the model size for each participant as another criterion. Such a criterion is necessary because smaller models could be easier to adapt to the edge devices in real-world applications. We used an ANOVA oneway test to compare the one-size-fits-all baseline model and two personalized models. Also, we applied a paired t-test to compare f1-score performances between the transfer learning strategy and PA framework.",
      "page_start": 5,
      "page_end": 5
    },
    {
      "section_name": "Vi. Results",
      "text": "",
      "page_start": 5,
      "page_end": 5
    },
    {
      "section_name": "A. Modality Fusion Evaluation",
      "text": "Table  II  shows the evaluation results of using SAN and MFN with different modalities of data. Our proposed MFN showed higher f1-scores than each of the SAN models. The p-values of the statistic tests were all smaller than 0.01, which indicated that our proposed MFN model performed statistically significantly better than the baseline SAN models in the f1scores.",
      "page_start": 6,
      "page_end": 6
    },
    {
      "section_name": "B. Model Personalization",
      "text": "Table  III  shows the results of the generalized MFN model and the personalized models, including transfer learning and personalized attention strategies, respectively. We observed improvements in the f1-score of the personalized models compared to the one-size-fits-all models. The statistical test (one-way ANOVA) also showed differences between the onesize-fits-all model and personalized models (p-value < 0.01). In addition, the comparison between our proposed PA model and the transfer learning method showed that the PA model performed better in terms of the f1-score (paired t-test, p-value < 0.01). Moreover, we found that the PA personalized model size was 68% smaller than the transfer learning personalized model size.",
      "page_start": 7,
      "page_end": 7
    },
    {
      "section_name": "Vii. Discussion",
      "text": "We tackled two common problems in multimodal in-thewild emotion detection: (i) missing modalities and (ii) model personalization. In previous sections, we showed that MFN can be adaptive to infer stress levels even in the presence of missing modality; and MFN provided better f1-score performance than multiple SAN models. The PA method also showed promising results with higher f1-scores using a smaller number of model parameters (lighter model size) than previous state-of-the-art methods. In this section, we discuss some of the posterior analysis from the results, as well as the practical implications and limitations of this work.",
      "page_start": 6,
      "page_end": 6
    },
    {
      "section_name": "A. Error Analysis",
      "text": "By analyzing the model outputs, we found that detecting stress labels showed higher accuracy than detecting non-stress labels. Such a situation was observed in both the generalized model and the individualized model. One benefit of such a phenomenon is that we can get more accurate estimations when using the model to help people under stress. Figure  5  shows the confusion matrices for the estimation values of onesize-fits-all MFN model and the PA framework, respectively. The two confusion matrices showed that the models achieved higher recall scores for stress classification than non-stressed  labels, with their recall being 60.8% and 83.1%, respectively.\n\nIn the PA model results, the recall score for non-stressed predictions was improved compared to the generalized model, which increased to 73.5%.\n\nAlthough personalized models improved model performance, there was a difference in the model performance for detecting stress and non-stress labels. Such differences might be caused by label distribution imbalance in the dataset. Although we applied the focal loss method, the label imbalance problem have not been fully solved.",
      "page_start": 6,
      "page_end": 6
    },
    {
      "section_name": "B. Personalized Stress Detection Insights",
      "text": "We found individual differences in participants' reported momentary stress levels. For example, the maximum, minimum, median percentages of stressed labels across each participant were 100%, 4.6%, and 45.7%, respectively with a standard deviation (STD) value of 31.0%. To investigate our model performances on individuals, we analyzed the stress detection results from MFN and PA on each subject. In the test results using the generalized model, 8 out of the 41 participants had f1-scores of 85% or higher, while 6 participants had f1-scores below 50%. According to our PA framework results, the number of participants with f1scores above 85% increased to 15, while only 2 participants had f1-scores below 50%. Among the 15 participants with high f1-scores in stress detection, we found all labels of 4 participants were reported as stressed. This analysis revealed that the model might estimate more accurate stress labels for these participants with stable subject stress patterns. To explore the relationship between the variability in stress labels and our model performance, we calculated the STD of the binary labels for all participants and applied K-Means algorithms to cluster them into two different groups (k-means centroids label STD: 0.125 (N=11) and 0.438 (N=30)) with the highest Silhouette score of 0.698 compared to other numbers (from 2 to 10) of clusters. With the PA framework, we observed that the f1scores (average: 86.4%) among participants with lower STD were significantly higher than the f1-scores (average: 73.4%) among the higher STD group (t-test, p-value < 0.01). On the other hand, the shifts of label distributions from training to test set might lead to difficulties in estimating stress labels accurately. For example, for the 2 participants who showed low f1-scores below 50% with the PA framework, we found that the differences in percentages of stressed labels between the training and test sets were both over 40%. For example, one participant reported 38% of labels as stressed in the training set; whereas 89% of labels as stressed in the test set.",
      "page_start": 7,
      "page_end": 7
    },
    {
      "section_name": "C. Interpretability On The Data Time Steps",
      "text": "To explore the contribution of each time step in the input sequence (60 minutes) to the model, we conducted a correlation analysis for generalized MFN and personalized attention branches in the PA framework, respectively. As the first self-attention blocks in both the generalized branch and personalized branch outputted high-level sequential representations learned from the input, we computed the vector correlations between each time step in the input sequence and the dimensions of intermediate outputs of both branches. Figure  6  shows the correlations between the input data and model intermediate outputs on each input time step. In both MFN and PA model, we found that as the time step got closer to the time point where the stress was reported, the input data were more correlated with the model output. In addition, we found that the correlations between the input and the output in the personalized branch were higher than those between the input and the generalized branch, which illustrated that the personalized attention for each participant learned more correlated representations than the generalized model.",
      "page_start": 7,
      "page_end": 7
    },
    {
      "section_name": "D. Implications 1) Modality Fusion:",
      "text": "This work provides an insight into using deep learning to solve the incomplete modalities issues in multimodal timeseries sensor data without discarding incomplete data or reconstructing the missing modalities. We have proved the effectiveness of MFN with two modalities in this paper. Such logic can be applied to other datasets with more modalities. For example, we can design more input branches to exploit modalities, and we can also use different output branches to estimate labels under various modalities missing scenarios.\n\n2) Personalization: Our proposed PA framework can significantly improve stress detection performance compared to generalized one-size-fits-all learning. The design of personalized branches makes it possible to save personalized parameters of the models on user-end edge devices. In real-world applications, we may use the proposed PA framework and distributed computing methods to combine the end-user small models with the server-side one-size-fits-all model to obtain accurate stress estimation for individuals.",
      "page_start": 8,
      "page_end": 8
    },
    {
      "section_name": "E. Limitations & Future Work",
      "text": "Although this work has made some progress in multimodal wearable sensor-based in-the-wild momentary stress detection, it is undeniable that there are still some limitations. First, as mentioned above, there exists the problem of label imbalance. As future work, in addition to trying weight-sensitive loss functions, we will also make new attempts in terms of data sampling, such as oversampling or undersampling to make the training set balanced. Second, the diversity of the participants' population could be improved. In the dataset, the age structure of our participants is relatively concentrated on younger age groups, and the gender of the participants is primarily female. In the future, we will collect data from more diverse populations and evaluate the fairness of the model and its adaptability to other users. Moreover, generally the deep learning systems perform well but are \"black boxes,\" and lack insight into the underlying mechanisms. The nonlinear design of neural networks makes it hard to interpret the weights and parameters of networks. At the same time, users may have difficulties trusting the feedback provided by \"black boxes\". Although understanding deep learning models is still an unsolved problem, in the future, we will extend our current model and bring some interpretability to our stress detection using partially interpretable deep learning design  [34] ,  [35] .",
      "page_start": 7,
      "page_end": 7
    },
    {
      "section_name": "Viii. Conclusion",
      "text": "We investigated personalized momentary stress estimation using a multimodal wearable dataset where missing data modality was observed. We proposed an MFN structure to adaptively fit data samples and infer stress levels with modality missing conditions. The MFN network shows a 1.6% higher f1-score in experiments compared to the performance of the baseline SAN model. Moreover, we designed a PA framework, which individually applied the MFN model to each subject's data. The PA method shows 2.3% higher f1-score performance with 68.9% smaller personalized model size than the previous state-of-the-art transfer learning method. Although we achieved some promising results, there are still challenges to overcome. In the future, we will propose new methods in solving our existing issues such as imbalanced data and increasing model interpretability and also test our methods in different datasets.",
      "page_start": 7,
      "page_end": 7
    }
  ],
  "figures": [
    {
      "caption": "Figure 1: ), which is",
      "page": 3
    },
    {
      "caption": "Figure 1: The self-attention mechanism. X is the data input, Q, K, and V are",
      "page": 4
    },
    {
      "caption": "Figure 2: The structure of the self-attention network (SAN) in this study. X is",
      "page": 4
    },
    {
      "caption": "Figure 2: , we deﬁned a",
      "page": 4
    },
    {
      "caption": "Figure 2: , to make the model deeper and gain",
      "page": 4
    },
    {
      "caption": "Figure 3: The structure of the modality fusion network. XGSR and XECG",
      "page": 4
    },
    {
      "caption": "Figure 3: . This MFN",
      "page": 4
    },
    {
      "caption": "Figure 3: ). Similarly, the exact optimization",
      "page": 4
    },
    {
      "caption": "Figure 4: shows the structure of the MFN-integrated",
      "page": 4
    },
    {
      "caption": "Figure 4: The structure of the modality fusion network-integrated personalized",
      "page": 5
    },
    {
      "caption": "Figure 5: shows the confusion matrices for the estimation values of one-",
      "page": 6
    },
    {
      "caption": "Figure 5: Confusion matrix tables of binary stress detection in test set using",
      "page": 6
    },
    {
      "caption": "Figure 6: The bar plots of average vector correlation coefﬁcients between the",
      "page": 7
    },
    {
      "caption": "Figure 6: shows the correlations between the input data and",
      "page": 7
    }
  ],
  "tables": [
    {
      "caption": "Table: No caption found",
      "data": [
        {
          "No.": "1\n2\n3\n4\n5\n6\n7\n8",
          "Feature": "Mean heart\nrate\nStandard deviation of heart rate variability’s\nR-R intervals\nRoot mean square of successive R-R differ-\nences\nLow frequency signal\n(power\nin the 0.04-\n0.15 Hz band)\nHigh frequency signal\n(power\nin the 0.15-\n0.40 Hz band)\nRatio of\nlow and high frequency\nRatio of very low (0.0033 - 0.04 Hz) and\nlow frequency\nHeart\nrate cycle",
          "Source": "ECG\nECG\nECG\nECG\nECG\nECG\nECG\nECG"
        },
        {
          "No.": "9\n10\n11\n12\n13\n14\n15\n16",
          "Feature": "GSR level\n- average GSR\nPhasic GSR -\nsignal power of\nthe phasic\nGSR signal\n(0.16-2.1 Hz)\nGSR response\nrate\n-\nnumber\nof GSR re-\nsponses\nin window divided by the\ntotally\nlength\nof\nthe window (i.e.\nresponses\nper\nsecond)\nGSR second\ndifference\n-\nsignal\npower\nin\nsecond difference from the GSR signal\nGSR response - number of GSR responses\nGSR magnitude - the sum of the magnitudes\nof GSR responses\nGSR duration -\nthe sum of\nthe magnitudes\nof GSR responses\nGSR area\n-\nthe\nsum of\nthe\narea of GSR\nresponses\nin seconds. The\narea\nis deﬁned\nusing\nthe\ntriangular method\n(1/2\nx GSR\nmagnitude x GSR duration)",
          "Source": "GSR\nGSR\nGSR\nGSR\nGSR\nGSR\nGSR\nGSR"
        }
      ],
      "page": 3
    },
    {
      "caption": "Table: No caption found",
      "data": [
        {
          "34.30%": "12.00%",
          "6.10%": "47.60%"
        }
      ],
      "page": 6
    },
    {
      "caption": "Table: No caption found",
      "data": [
        {
          "29.80%": "16.50%",
          "8.00%": "45.70%"
        }
      ],
      "page": 6
    },
    {
      "caption": "Table: No caption found",
      "data": [
        {
          "Personalized Model Size": "-",
          "F1-Score": "0.693 ± 0.006"
        },
        {
          "Personalized Model Size": "29.3 MB",
          "F1-Score": "0.751 ± 0.010"
        },
        {
          "Personalized Model Size": "9.1 MB",
          "F1-Score": "0.774 ± 0.007"
        }
      ],
      "page": 6
    }
  ],
  "citations": [
    {
      "citation_id": "1",
      "title": "Effects of stress on immune function: the good, the bad, and the beautiful",
      "authors": [
        "S Firdaus",
        "Dhabhar"
      ],
      "year": "2014",
      "venue": "Immunologic research"
    },
    {
      "citation_id": "2",
      "title": "Good stress, bad stress and oxidative stress: insights from anticipatory cortisol reactivity",
      "authors": [
        "Kirstin Aschbacher",
        "O' Aoife",
        "Owen Donovan",
        "Wolkowitz",
        "Yali Firdaus S Dhabhar",
        "Elissa Su",
        "Epel"
      ],
      "year": "2013",
      "venue": "Psychoneuroendocrinology"
    },
    {
      "citation_id": "3",
      "title": "Disasters and the heart: a review of the effects of earthquake-induced stress on cardiovascular disease",
      "authors": [
        "Kazuomi Kario",
        "S Mcewen Bruce",
        "G Pickering Thomas"
      ],
      "year": "2003",
      "venue": "Hypertension Research"
    },
    {
      "citation_id": "4",
      "title": "Effects of stress on the immune system",
      "authors": [
        "Anthony David N Khansari",
        "Robert Murgo",
        "Faith"
      ],
      "year": "1990",
      "venue": "Immunology today"
    },
    {
      "citation_id": "5",
      "title": "Towards job stress recognition based on behavior and physiological features",
      "authors": [
        "Wendy Sanchez",
        "Alicia Martinez",
        "Miguel Gonzalez"
      ],
      "year": "2017",
      "venue": "International conference on ubiquitous computing and ambient intelligence"
    },
    {
      "citation_id": "6",
      "title": "Monitoring stress with a wrist device using context",
      "authors": [
        "Martin Gjoreski",
        "Mitja Luštrek",
        "Matjaž Gams",
        "Hristijan Gjoreski"
      ],
      "year": "2017",
      "venue": "Journal of biomedical informatics"
    },
    {
      "citation_id": "7",
      "title": "",
      "authors": [
        "Yuan Shi",
        "Minh Nguyen",
        "Patrick Blitz",
        "Brian French",
        "Scott Fisk",
        "Fernando De La"
      ],
      "year": "2010",
      "venue": ""
    },
    {
      "citation_id": "8",
      "title": "Smil: Multimodal learning with severely missing modality",
      "authors": [
        "Mengmeng Ma",
        "Jian Ren",
        "Long Zhao",
        "Sergey Tulyakov",
        "Cathy Wu",
        "Xi Peng"
      ],
      "year": "2021",
      "venue": "Smil: Multimodal learning with severely missing modality",
      "arxiv": "arXiv:2103.05677"
    },
    {
      "citation_id": "9",
      "title": "Variational methods for conditional multimodal deep learning",
      "authors": [
        "Gaurav Pandey",
        "Ambedkar Dukkipati"
      ],
      "year": "2017",
      "venue": "2017 International Joint Conference on Neural Networks (IJCNN)"
    },
    {
      "citation_id": "10",
      "title": "Lrmm: learning to recommend with missing modalities",
      "authors": [
        "Cheng Wang",
        "Mathias Niepert",
        "Hui Li"
      ],
      "year": "2018",
      "venue": "Lrmm: learning to recommend with missing modalities",
      "arxiv": "arXiv:1808.06791"
    },
    {
      "citation_id": "11",
      "title": "Multimodal autoencoder: A deep learning approach to filling in missing sensor data and enabling better mood prediction",
      "authors": [
        "Natasha Jaques",
        "Sara Taylor",
        "Akane Sano",
        "Rosalind Picard"
      ],
      "year": "2017",
      "venue": "2017 Seventh International Conference on Affective Computing and Intelligent Interaction (ACII)"
    },
    {
      "citation_id": "12",
      "title": "Ssim-a deep learning approach for recovering missing time series sensor data",
      "authors": [
        "Yi-Fan Zhang",
        "Peter Thorburn",
        "Wei Xiang",
        "Peter Fitch"
      ],
      "year": "2019",
      "venue": "IEEE Internet of Things Journal"
    },
    {
      "citation_id": "13",
      "title": "Data imputation and compression for parkinson's disease clinical questionnaires",
      "authors": [
        "Maxime Peralta",
        "Pierre Jannin",
        "Claire Haegelen",
        "John Sh Baxter"
      ],
      "year": "2021",
      "venue": "Artificial Intelligence in Medicine"
    },
    {
      "citation_id": "14",
      "title": "Alexandru Ghiurut ¸an, Camelia Lemnaru, and Mihaela Dîns ¸oreanu. An early fusion approach for multimodal emotion recognition using deep recurrent networks",
      "authors": [
        "Beniamin Bucur",
        "Iulia S ¸omfelean"
      ],
      "year": "2018",
      "venue": "2018 IEEE 14th International Conference on Intelligent Computer Communication and Processing (ICCP)"
    },
    {
      "citation_id": "15",
      "title": "M3er: Multiplicative multimodal emotion recognition using facial, textual, and speech cues",
      "authors": [
        "Trisha Mittal",
        "Uttaran Bhattacharya",
        "Rohan Chandra"
      ],
      "year": "2020",
      "venue": "Proceedings of the AAAI Conference on Artificial Intelligence"
    },
    {
      "citation_id": "16",
      "title": "Continuous stress detection using wearable sensors in real life: Algorithmic programming contest case study",
      "authors": [
        "Yekta Said Can",
        "Niaz Chalabianloo",
        "Deniz Ekiz",
        "Cem Ersoy"
      ],
      "year": "2019",
      "venue": "Sensors"
    },
    {
      "citation_id": "17",
      "title": "Personalized multitask learning for predicting tomorrow's mood, stress, and health",
      "authors": [
        "Ann Sara",
        "Natasha Taylor",
        "Ehimwenma Jaques",
        "Akane Nosakhare",
        "Rosalind Sano",
        "Picard"
      ],
      "year": "2017",
      "venue": "IEEE Transactions on Affective Computing"
    },
    {
      "citation_id": "18",
      "title": "Model adaptation and personalization for physiological stress detection",
      "authors": [
        "Aaqib Saeed",
        "Tanir Ozcelebi",
        "Johan Lukkien",
        "Jan Bf Van Erp",
        "Stojan Trajanovski"
      ],
      "year": "2018",
      "venue": "2018 IEEE 5th International Conference on Data Science and Advanced Analytics (DSAA)"
    },
    {
      "citation_id": "19",
      "title": "Passive sensor data based future mood, health, and stress prediction: User adaptation using deep learning",
      "authors": [
        "Han Yu",
        "Akane Sano"
      ],
      "year": "2020",
      "venue": "2020 42nd Annual International Conference of the IEEE Engineering in Medicine & Biology Society (EMBC)"
    },
    {
      "citation_id": "20",
      "title": "Improving students' daily life stress forecasting using lstm neural networks",
      "authors": [
        "Terumi Umematsu",
        "Akane Sano",
        "Sara Taylor",
        "Rosalind Picard"
      ],
      "year": "2019",
      "venue": "2019 IEEE EMBS International Conference on Biomedical & Health Informatics (BHI)"
    },
    {
      "citation_id": "21",
      "title": "Personalized wellbeing prediction using behavioral, physiological and weather data",
      "authors": [
        "Han Yu",
        "Elizabeth Klerman",
        "Rosalind Picard",
        "Akane Sano"
      ],
      "year": "2019",
      "venue": "2019 IEEE EMBS International Conference on Biomedical & Health Informatics (BHI)"
    },
    {
      "citation_id": "22",
      "title": "Deep adversarial learning for multi-modality missing data completion",
      "authors": [
        "Lei Cai",
        "Zhengyang Wang",
        "Hongyang Gao",
        "Dinggang Shen",
        "Shuiwang Ji"
      ],
      "year": "2018",
      "venue": "Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining"
    },
    {
      "citation_id": "23",
      "title": "Towards large-scale physiological stress detection in an ambulant environment",
      "authors": [
        "Elena Smets"
      ],
      "year": "2018",
      "venue": "Towards large-scale physiological stress detection in an ambulant environment"
    },
    {
      "citation_id": "24",
      "title": "Stock price prediction using lstm, rnn and cnnsliding window model",
      "authors": [
        "Sreelekshmy Selvin",
        "Vinayakumar",
        "Vijay Ea Gopalakrishnan",
        "Krishna Menon",
        "Soman"
      ],
      "year": "2017",
      "venue": "2017 international conference on advances in computing, communications and informatics (icacci)"
    },
    {
      "citation_id": "25",
      "title": "Learning phrase representations using rnn encoder-decoder for statistical machine translation",
      "authors": [
        "Kyunghyun Cho",
        "Bart Van Merriënboer",
        "Caglar Gulcehre",
        "Dzmitry Bahdanau",
        "Fethi Bougares",
        "Holger Schwenk",
        "Yoshua Bengio"
      ],
      "year": "2014",
      "venue": "Learning phrase representations using rnn encoder-decoder for statistical machine translation",
      "arxiv": "arXiv:1406.1078"
    },
    {
      "citation_id": "26",
      "title": "Polyphonic music generation by modeling temporal dependencies using a rnn-dbn",
      "authors": [
        "Kratarth Goel",
        "Raunaq Vohra",
        "Jajati Keshari"
      ],
      "year": "2014",
      "venue": "International Conference on Artificial Neural Networks"
    },
    {
      "citation_id": "27",
      "title": "Survey on the attention based rnn model and its applications in computer vision",
      "authors": [
        "Feng Wang"
      ],
      "year": "2016",
      "venue": "Survey on the attention based rnn model and its applications in computer vision",
      "arxiv": "arXiv:1601.06823"
    },
    {
      "citation_id": "28",
      "title": "Advances in joint ctc-attention based end-to-end speech recognition with a deep cnn encoder and rnn-lm",
      "authors": [
        "Takaaki Hori",
        "Shinji Watanabe",
        "Yu Zhang",
        "William Chan"
      ],
      "year": "2017",
      "venue": "Advances in joint ctc-attention based end-to-end speech recognition with a deep cnn encoder and rnn-lm",
      "arxiv": "arXiv:1706.02737"
    },
    {
      "citation_id": "29",
      "title": "Attention is all you need",
      "authors": [
        "Ashish Vaswani",
        "Noam Shazeer",
        "Niki Parmar",
        "Jakob Uszkoreit",
        "Llion Jones",
        "Aidan Gomez",
        "Lukasz Kaiser",
        "Illia Polosukhin"
      ],
      "year": "2017",
      "venue": "Attention is all you need",
      "arxiv": "arXiv:1706.03762"
    },
    {
      "citation_id": "30",
      "title": "The evolved transformer",
      "authors": [
        "David So",
        "Quoc Le",
        "Chen Liang"
      ],
      "year": "2019",
      "venue": "International Conference on Machine Learning"
    },
    {
      "citation_id": "31",
      "title": "Deep residual learning for image recognition",
      "authors": [
        "Kaiming He",
        "Xiangyu Zhang",
        "Shaoqing Ren",
        "Jian Sun"
      ],
      "year": "2016",
      "venue": "Proceedings of the IEEE conference on computer vision and pattern recognition"
    },
    {
      "citation_id": "32",
      "title": "Nrpa: neural recommendation with personalized attention",
      "authors": [
        "Hongtao Liu",
        "Fangzhao Wu",
        "Wenjun Wang",
        "Xianchen Wang",
        "Pengfei Jiao",
        "Chuhan Wu",
        "Xing Xie"
      ],
      "year": "2019",
      "venue": "Proceedings of the 42nd International ACM SIGIR Conference on Research and Development in Information Retrieval"
    },
    {
      "citation_id": "33",
      "title": "Focal loss for dense object detection",
      "authors": [
        "Tsung-Yi Lin",
        "Priya Goyal",
        "Ross Girshick",
        "Kaiming He",
        "Piotr Dollár"
      ],
      "year": "2017",
      "venue": "Proceedings of the IEEE international conference on computer vision"
    },
    {
      "citation_id": "34",
      "title": "Exploring interpretable lstm neural networks over multi-variable data",
      "authors": [
        "Tian Guo",
        "Tao Lin",
        "Nino Antulov-Fantulin"
      ],
      "year": "2019",
      "venue": "Exploring interpretable lstm neural networks over multi-variable data",
      "arxiv": "arXiv:1905.12034"
    },
    {
      "citation_id": "35",
      "title": "Temporal fusion transformers for interpretable multi-horizon time series forecasting",
      "authors": [
        "Bryan Lim",
        "Sercan Arik",
        "Nicolas Loeff",
        "Tomas Pfister"
      ],
      "year": "2019",
      "venue": "Temporal fusion transformers for interpretable multi-horizon time series forecasting",
      "arxiv": "arXiv:1912.09363"
    }
  ]
}